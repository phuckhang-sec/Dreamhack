from pwn import *
from Crypto.Cipher import DES
from tqdm import trange

io = process(["python3", "prob.py"])

io.recvuntil(b":> ")
hint = bytes.fromhex(io.recvline().decode())

for i in trange(2**32):
    key = b'Dream_' + i.to_bytes(4, "big") + b'Hacker'
    key1 = key[:8]
    key2 = key[8:]
    cipher1 = DES.new(key1, DES.MODE_ECB)
    cipher2 = DES.new(key2, DES.MODE_ECB)
    if cipher2.encrypt(cipher1.encrypt(b'DreamHack_blocks')) == hint:
        print("Success")
        break
